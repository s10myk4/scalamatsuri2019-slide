### 分析と概念設計

![development-flow](assets/img/developmemt-flow.png)

Note:

* TODO: このフェーズでは以下を説明する 
    * 使う手法
    * How(実際にその手法を適用してみる)
    * アウトプット(適用した結果こうなる)

---

@snap[north-west text-gray span-100]
@size[1.5em](分析と概念設計フェーズの問題領域)
@snapend

#### ユースケース記述を分析・検証

- ドメインモデルのアップデート
- 新たなドメインモデルの抽出
- ドメインモデルに振る舞いを割り当てる

@snap[south-west template-note text-gray]
@snapend

Note:

このフェーズの目的は前のフェーズでのアウトプットであるユースケース記述の妥当性を検証すること、
新たなドメインモデルの発掘・アップデートです。

また、ドメインモデルとふるまいの関係を明らかにしてきます。

これがそのまま成果物となります。

---

@snap[north-west text-gray span-100]
@size[1.5em](概念設計で重要なこと)
@snapend

TODO どこに差し込むか再考
####  概念設計の段階では、詳細の技術に関する概念を用いない
(ex. DB、http)

Note:
ここで抽出したモデルは、DBなどの固有の技術に依存する概念ではなく、
このソフトウェア上で扱う業務に関連したモデルである

TODO もっと色々具体的な例を入れて重要な観点をわかりやすく説明したい

---

@snap[north-west text-gray span-100]
@size[1.5em](利用する手法)
@snapend

#### ロバストネス分析

![](assets/img/robustness/robustness-icon.png)

@snap[south-west template-note text-gray]
@snapend

Note:

バウンダリ、エンティティ、コントローラというステレオタイプを用いて図を作成していきます

バウンダリは、システムと外部とのインターフェースを表していて、Webページの画面とかが具体的な例です
エンティティは、ドメイン上に出てくるモデル
コントローラは、バウンダリやエンティティを繋いだり、ソフトウェアの機能を表します

TODO

* 簡単なロバストネス分析のサンプル
* BCE の説明
---

![](assets/img/robustness/robustness-sample.png)
@snap[south-east template-note]
@box[text-white rounded bg-orange box-padding text-05](Source: [ユースケース駆動開発実践ガイド 図5.31](https://www.shoeisha.co.jp/book/detail/9784798114453))
@snapend

---

@snap[north-west text-gray span-100]
@size[1.5em](記法のルール)
@snapend

![](assets/img/robustness/robustness-rules.png)

Note:
アクターはバウンダリとしか関係を持てません
バウンダリとエンティティは、互いに直接関係を持つことはできません。コントローラを通じる必要があります
エンティティは、ほかのエンティティと直接関係を持つことはできません。コントローラを通じる必要があります
バウンダリは、ほかのバウンダリと直接関係を持つことはできません。コントローラを通じる必要があります

---

@snap[north-west text-gray span-100]
@size[1.5em](ロバストネス分析とは)
@snapend

- ICONIXプロセスの奥義
- ユースケースの曖昧さを解消する分析方法
    - ドメインモデルの発見
    - ドメインモデルと振る舞いの関連性
    
@snap[south-west template-note text-gray]
@snapend

Note:
ICONIXプロセスは初稿のドメインモデルを不完全なものだと仮定しており、
取りこぼしていたオブジェクトがロバストネス分析中で発見されると想定しています。
初稿のユースケース記述はたいてい曖昧で不完全であり、不正確なものになりがちです
それをサポートするためにロバストネス図による分析を行います。

ロバストネス分析の主要な目的は2つです。
ユースケース記述から曖昧さを取り除く
見逃したドメインモデルを発見する

ロバストネス図ではバウンダリオブジェクトでGUI要素を、コントローラでソフトウェア機能を、
エンティティでドメインオブジェクトを表現します。

---

@snap[north-west text-gray span-100]
@size[1.5em](オブジェクト(BCE)抽出)
@snapend


#### 正常系

```text
ユーザーは、自分の所有している戦士(E)の中から1人を選んでタップする(C)
システムは、戦士詳細画面(B)を表示する(C)
ユーザーは、装備ボタン(B)をタップする(C)
システムは、武器一覧(E)を取得し、武器一覧画面(B)に表示する(C)
ユーザーは、戦士(E)に装備したい武器(E)を一覧から選択して、決定ボタン(B)をタップする(C)
システムは、戦士のレベル(E)が選択された武器のレベル(E)条件以上であるかを確認する(C)
システムは、選択した武器の属性(E)と戦士の属性(E)が同じであるかを確認する(C)
システムは、選択した武器を装備した戦士(E)を作成する(C)
システムは、"装備が完了しました"というメッセージを画面(B)に表示する(C)
```

```
B -> バウンダリ      C -> コントローラ     E -> エンティティ
```


Note:

ロバストネス図を作成する前に、ロバストネス図にマッピングするオブジェクトを抽出しておくと効率的です
バウンダリをB、コントローラをC、エンティティをEとしてユースケース記述内にマークをつけていきます

---

@snap[north-west text-gray span-100]
@size[1.5em](オブジェクト(BCE)抽出)
@snapend


#### 異常系
```text
・戦士のレベル(E)が選択した武器のレベル条件(E)を満たしていない場合
システムは、"この武器を装備するするための条件を満たしていません"というメッセージを戦士詳細画面(B)に表示する(C)

・戦士の属性(E)と選択した武器の属性(E)が異なる場合
システムは、"この武器を装備するための条件を満たしていません"というメッセージを戦士詳細画面(B)に表示する(C)

・武器(E)がすでに装備されている場合
システムは、"すでに武器が装備されています"というメッセージを戦士詳細画面(B)に表示する(C)
```

---

@snap[north-west text-gray span-100]
@size[1.5em](ロバストネス分析)
@snapend

![](assets/img/robustness/first-robustness-diagram.png)

@snap[south-west template-note text-gray]
@snapend

Note:
このロバストネス図を眺めていると何か違和感を感じませんか？
20秒ほど眺めてどこが変なのか

---

@snap[north-west text-gray span-100]
@size[1.5em](ロバストネス分析)
@snapend

#### 疑問点
- 武器を装備する操作が発生していないのに、バリデーションをしている？

@snap[south-west template-note text-gray]
@snapend

Note:
戦士に武器を装備する操作が発生していないのに、武器一覧画面からバリデーション操作が繋がっているのは、
操作の流れとしておかしい

---

@snap[north-west text-gray span-100]
@size[1.5em](ロバストネス分析)
@snapend

![](assets/img/robustness/updated-robustness-diagram.png)

@snap[south-west template-note text-gray]
@snapend

Note:
戦士に武器を装備するという操作が発生することで、バリデーションが発生するように図を書き換えて見ました。  

---

@snap[north-west text-gray span-100]
@size[1.5em](ユースケース記述の更新)
@snapend

```diff
ユーザーは、自分の所有している戦士の中から1人を選んでタップする
システムは、戦士詳細画面を表示する
ユーザーは、装備ボタンをタップする
システムは、武器一覧を取得し、武器一覧画面に表示する
ユーザーは、戦士に装備したい武器を一覧から選択して、決定ボタンをタップする
+ システムは、戦士に武器を装備する
システムは、戦士のレベルが選択された武器のレベル条件以上であるかを確認する
システムは、選択した武器の属性と戦士の属性が同じであるかを確認する
- システムは、選択した武器を装備した戦士を作成する
システムは、"装備が完了しました"というメッセージを画面に表示する
```

@snap[south-west template-note text-gray]
@snapend

---

### これって全部のユースケースにやるの大変じゃない？
- スライムを倒すのに毎回必殺技が必要ですか？
//TODO ブラックアウト

Note:
正直色々図書いたり大変だなって感じる方も多いかと思いますが、
ロバストネス分析はICONIXプロセスにおける奥義 / 真髄とされています。

スライムを倒すのに毎回奥義 / 必殺技を使いますか？
倒すのが大変そうな敵のときに、必殺技を使う感覚でいいと思います
技を習得するためにまずは何度か素振りをしてみる必要はあるかと思います。

---

### 重要なビジネスドメインや、複雑性が高そうなユースケースにおいて実施するのが良さそう


